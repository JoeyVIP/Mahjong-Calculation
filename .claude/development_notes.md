# 開發筆記

## 開發階段規劃

### 第一階段：基礎建置（1-2天）
- 初始化Vite + React + TypeScript專案
- 設定Tailwind CSS
- 安裝Framer Motion
- 建立基本資料夾結構
- 設定TypeScript類型定義
- 準備麻將牌圖示資源

### 第二階段：核心UI組件（2-3天）
- Header組件
- 設定面板組件
  - 圈風選擇器（大按鈕）
  - 座位風選擇器（大按鈕）
  - 莊家Toggle
  - 自摸/胡別人切換
  - 底台金額選擇器
- TileSelector組件（選牌區）
  - 分類Tab
  - 牌面網格
- HandDisplay組件（手牌區）
- 基本佈局和樣式

### 第三階段：計算引擎（2-3天）
- 胡牌結構驗證
- 基本台數計算
- 圈風台計算
- 門風台計算
- 莊家台計算
- 對對胡、清一色等判斷
- 花牌計算
- 金額計算
- 測試所有計算邏輯

### 第四階段：結果展示（1-2天）
- ResultPanel組件
- 總台數展示（大數字）
- 台種列表
- 金額計算展示
- 公式顯示
- 展開/收合詳細說明

### 第五階段：動畫和互動（2-3天）
- 選牌動畫
- 手牌增減動畫
- 結果面板滑入動畫
- 台數計數動畫
- 按鈕點擊回饋
- 頁面切換過渡
- 微互動細節

### 第六階段：優化和測試（2-3天）
- 響應式調整（平板、桌面）
- 效能優化
- 各種牌型測試
- 使用者測試
- 修正Bug
- 調整UI細節

### 第七階段：打磨和發布（1-2天）
- 最終視覺調整
- Loading狀態
- 錯誤處理
- SEO優化
- 建置和部署
- 撰寫README

## 技術實作重點

### 牌面圖示處理
- **選項1**：使用Unicode麻將字符（簡單但可能不夠美觀）
- **選項2**：使用SVG圖標（推薦，完全自訂）
- **選項3**：使用圖片（確保大小優化）
- **建議**：製作或尋找高品質SVG麻將牌圖示

### 動畫效能
- 使用transform和opacity做動畫（GPU加速）
- 避免觸發layout的屬性（width, height等）
- 使用will-change提示瀏覽器
- 控制同時動畫的元素數量

### 狀態管理
- 使用useState管理簡單狀態
- 使用useReducer管理複雜設定狀態
- 建立custom hooks封裝邏輯
- useCalculation hook處理計算

### 計算邏輯組織
- 每個台種獨立函數
- 使用工廠模式產生台種物件
- 建立測試資料覆蓋所有情況
- 使用TypeScript確保型別安全

### 程式碼組織
```
src/
├── components/
│   ├── Header.tsx
│   ├── SettingsPanel/
│   ├── TileSelector/
│   ├── HandDisplay/
│   ├── ResultPanel/
│   └── common/
├── utils/
│   ├── calculator.ts
│   ├── validator.ts
│   └── formatter.ts
├── constants/
│   ├── tiles.ts
│   ├── rules.ts
│   └── animations.ts
├── types/
│   └── index.ts
├── hooks/
│   ├── useCalculation.ts
│   └── useHandState.ts
└── App.tsx
```

### 樣式組織
- 使用Tailwind的@apply抽取共用樣式
- 建立設計系統常數（顏色、間距）
- 使用CSS變數做主題色
- 考慮深色模式（未來）

## 已知挑戰和解決方案

### 挑戰1：手機螢幕空間有限
**解決**：
- 使用摺疊面板
- 結果用浮動面板從底部滑入
- 優先顯示最重要資訊

### 挑戰2：選牌可能很多次點擊
**解決**：
- 大按鈕減少誤觸
- 流暢動畫讓等待不無聊
- 考慮加入快捷輸入（未來）

### 挑戰3：新手不懂規則
**解決**：
- 每個台種都有說明
- 圈風門風特別標註
- 可展開查看詳細規則
- 使用icon和顏色輔助理解

### 挑戰4：計算邏輯複雜
**解決**：
- 模組化每個判斷
- 完整的單元測試
- 使用TypeScript防止錯誤
- 詳細的註解

### 挑戰5：動畫效能
**解決**：
- 使用Framer Motion最佳化
- 限制同時動畫數量
- 使用CSS transform
- 測試低階裝置

## 待辦清單

### 設計資源
- [ ] 尋找或設計麻將牌SVG圖示
- [ ] 設計App圖標
- [ ] 準備各種螢幕尺寸的測試

### 開發前置
- [ ] 建立設計系統
- [ ] 準備測試資料
- [ ] 設定ESLint和Prettier

### 開發中
- [ ] 實作所有核心組件
- [ ] 實作計算引擎
- [ ] 加入動畫
- [ ] 響應式調整

### 測試
- [ ] 單元測試計算邏輯
- [ ] 各種牌型測試
- [ ] 跨瀏覽器測試
- [ ] 真實裝置測試

### 發布前
- [ ] 效能優化
- [ ] 無障礙檢查
- [ ] SEO設定
- [ ] 撰寫文件
